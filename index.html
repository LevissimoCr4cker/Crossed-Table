<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>School Criterion Distribution</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', Arial, sans-serif;
    }

    body {
      background: rgba(255, 255, 255, 0.95);
      color: #333;
      padding: 20px;
      position: relative;
      min-height: 100vh;
      overflow-x: hidden;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .header-container {
      position: relative;
      text-align: center;
      padding: 20px;
      background: rgba(30, 58, 138, 0.9);
      color: #fff;
      font-size: 1.8rem;
      font-weight: 700;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      margin-bottom: 20px;
      border-radius: 8px;
      backdrop-filter: blur(5px);
    }

    h1 {
      display: inline;
      vertical-align: middle;
    }

    .info-icon {
      display: inline-block;
      margin-left: 10px;
      font-size: 1.5rem;
      color: rgba(59, 130, 246, 0.7);
      cursor: pointer;
      transition: all 0.3s ease;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.3));
      vertical-align: middle;
    }

    .info-icon:hover {
      color: rgba(37, 99, 235, 0.8);
      transform: translateY(-2px);
    }

    .tooltip {
      visibility: hidden;
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.95);
      color: #4b5563;
      padding: 15px;
      border-radius: 8px;
      width: 280px;
      font-size: 0.9rem;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      line-height: 1.4;
      backdrop-filter: blur(5px);
      margin-top: 10px;
    }

    .info-icon:hover .tooltip {
      visibility: visible;
    }

    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 20px auto;
      max-width: 600px;
      flex-wrap: wrap;
      background: rgba(255, 255, 255, 0.95);
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(3px);
    }

    select, button {
      padding: 10px 15px;
      font-size: 1rem;
      border: none;
      border-radius: 5px;
      background: rgba(59, 130, 246, 0.7);
      color: #fff;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    select:hover, button:hover {
      background: rgba(37, 99, 235, 0.8);
      transform: translateY(-2px);
    }

    select:focus, button:focus {
      outline: 2px solid #1e40af;
    }

    .controls label {
      color: #4b5563;
    }

    .chart-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 30px auto;
      max-width: 600px;
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      backdrop-filter: blur(5px);
    }

    canvas {
      width: 100% !important;
      height: 400px !important;
    }

    .return-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 10px 20px;
      font-size: 1rem;
      background: rgba(59, 130, 246, 0.7);
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .return-btn:hover {
      background: rgba(37, 99, 235, 0.8);
      transform: translateY(-2px);
    }

    .bar-graph-btn {
      position: fixed;
      bottom: 20px;
      left: 20px;
      padding: 10px;
      font-size: 1.5rem;
      background: rgba(59, 130, 246, 0.7);
      color: #fff;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .bar-graph-btn:hover {
      background: rgba(37, 99, 235, 0.8);
      transform: translateY(-2px);
    }

    @media (max-width: 768px) {
      .header-container {
        font-size: 1.5rem;
        padding: 15px;
      }

      .info-icon {
        font-size: 1.3rem;
        margin-left: 8px;
      }

      .tooltip {
        width: 240px;
        font-size: 0.85rem;
        margin-top: 8px;
      }

      .controls {
        flex-direction: column;
        gap: 15px;
        padding: 10px;
      }

      select, button {
        width: 100%;
        max-width: 300px;
      }

      .chart-container {
        padding: 15px;
      }

      canvas {
        height: 300px !important;
      }

      .return-btn, .bar-graph-btn {
        bottom: 15px;
        padding: 8px;
        font-size: 0.9rem;
      }

      .bar-graph-btn {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }
    }

    @media (max-width: 480px) {
      .header-container {
        font-size: 1.2rem;
        padding: 10px;
      }

      .info-icon {
        font-size: 1.2rem;
        margin-left: 6px;
      }

      .tooltip {
        width: 200px;
        font-size: 0.8rem;
        margin-top: 6px;
      }

      .chart-container {
        padding: 10px;
      }

      canvas {
        height: 250px !important;
      }

      .return-btn, .bar-graph-btn {
        bottom: 10px;
        padding: 6px;
        font-size: 0.8rem;
      }

      .bar-graph-btn {
        width: 36px;
        height: 36px;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="header-container">
    <h1>School Criterion Distribution</h1>
    <div class="info-icon">‚ìò
      <div class="tooltip">
        This section shows how schools are distributed for each criterion. For example, if you select ‚ÄúScholarship,‚Äù you can see how many schools received each rating. If most schools are rated 3, a school rated 5 is above average and one rated 1 is below. If most schools are rated 5, then a school rated 5 is around the average. You can also switch to bar graphs for a clearer visualization.
      </div>
    </div>
  </div>

  <div class="controls">
    <label for="criterion">Select Criterion:</label>
    <select id="criterion">
      <option value="Scholarship">Scholarship</option>
      <option value="Academic Quality">Academic Quality</option>
      <option value="Employment Opportunities">Employment Opportunities</option>
      <option value="Innovation">Innovation</option>
      <option value="International">International</option>
      <option value="Research">Research</option>
      <option value="Infrastructure">Infrastructure</option>
      <option value="Sports">Sports</option>
      <option value="Food">Food</option>
      <option value="Environment">Environment</option>
    </select>
    <button id="updateBtn">Update Chart</button>
  </div>

  <div class="chart-container">
    <canvas id="pieChart"></canvas>
  </div>

  <button class="return-btn" onclick="window.location.href='index.html'">Return to Home</button>
  <button class="bar-graph-btn" onclick="window.location.href='graphics.html'" title="View Bar Graphs">üìä</button>

  <script>
    let schools = [];
    let pieChart = null;

    // Load CSV
    async function loadCSV() {
      const response = await fetch("data.csv");
      const text = await response.text();
      const lines = text.trim().split("\n");
      const headers = lines[0].split(",");
      schools = lines.slice(1).map(line => {
        const values = line.split(",");
        const obj = {};
        headers.forEach((h, i) => {
          const key = h.trim();
          const value = values[i]?.trim();
          obj[key] = isNaN(value) ? value : Number(value);
        });
        return obj;
      });
      updateChart();
    }

    // Count how many schools have 1,2,3,4,5 for a criterion
    function getCounts(criterion) {
      const counts = [0, 0, 0, 0, 0];
      schools.forEach(s => {
        const val = s[criterion];
        if (val >= 1 && val <= 5) counts[val - 1]++;
      });
      return counts;
    }

    // Draw pie chart
    function updateChart() {
      const criterion = document.getElementById("criterion").value;
      const counts = getCounts(criterion);
      const ctx = document.getElementById("pieChart").getContext("2d");

      if (pieChart) pieChart.destroy();
      pieChart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ["1 √©toile", "2 √©toiles", "3 √©toiles", "4 √©toiles", "5 √©toiles"],
          datasets: [{
            data: counts,
            backgroundColor: ["#f44336", "#ff9800", "#ffeb3b", "#4caf50", "#2196f3"]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { position: 'bottom' },
            title: { display: true, text: `Distribution of Schools for ${criterion}` }
          },
          animation: {
            duration: 1000,
            easing: 'easeInOutQuad'
          }
        }
      });
    }

    // Button click updates chart
    document.getElementById("updateBtn").addEventListener("click", updateChart);

    loadCSV();
  </script>
</body>
</html>