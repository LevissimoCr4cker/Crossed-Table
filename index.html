<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>School Analyzer</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>School Analyzer</header>
  <div class="container" id="criteria-container"></div>
  <div class="btn-container">
    <button id="findBtn" class="btn">Find Top Matches</button>
    <button id="statsBtn" class="btn secondary">View Classification Stats</button>
    <button id="graphBtn" class="btn third">View Graphs</button>
    <button id="apoBtn" class="btn four">View Statistiques</button>
    <button id="edcBtn" class="btn five edcBtn">EDC</button>
  </div>
  <div class="burger-menu" id="burgerMenu">
    <div class="burger-icon" id="burgerIcon">â˜° Menu</div>
    <div class="burger-menu-content" id="burgerMenuContent">
      <button id="findBtnMobile" class="btn">Find Top Matches</button>
      <button id="statsBtnMobile" class="btn secondary">View Classification Stats</button>
      <button id="graphBtnMobile" class="btn third">View Graphs</button>
      <button id="apoBtnMobile" class="btn four">View Statistiques</button>
      <button id="edcBtnMobile" class="btn five edcBtn">EDC</button>
    </div>
  </div>
  <div class="results" id="results"></div>

  <script>
    // Toggle burger menu
    const burgerIcon = document.getElementById('burgerIcon');
    const burgerMenu = document.getElementById('burgerMenu');
    burgerIcon.addEventListener('click', () => {
      burgerMenu.classList.toggle('active');
    });

    // Button event listeners (desktop)
    document.getElementById('statsBtn').addEventListener('click', () => {
      window.location.href = 'stats.html';
    });

    document.getElementById('graphBtn').addEventListener('click', () => {
      window.location.href = 'graph.html';
    });

    document.getElementById('apoBtn').addEventListener('click', () => {
      window.location.href = 'graphics.html';
    });

    document.getElementById('edcBtn').addEventListener('click', () => {
      window.location.href = 'edc.html';
    });

    // Button event listeners (mobile)
    document.getElementById('statsBtnMobile').addEventListener('click', () => {
      window.location.href = 'stats.html';
    });

    document.getElementById('graphBtnMobile').addEventListener('click', () => {
      window.location.href = 'graph.html';
    });

    document.getElementById('apoBtnMobile').addEventListener('click', () => {
      window.location.href = 'graphics.html';
    });

    document.getElementById('edcBtnMobile').addEventListener('click', () => {
      window.location.href = 'edc.html';
    });

    // Existing JavaScript for criteria, fetching data, and finding matches
    const criteria = [
      "Scholarship Accessibility",
      "Academic Quality",
      "Employment Opportunities",
      "Innovation & Modern Programs",
      "International Environment",
      "Research Activity",
      "Infrastructure & IT Support",
      "Sports & Campus Life",
      "Food & Dining Facilities",
      "Campus Environment"
    ];

    let universities = [];
    fetch('data/schools.json')
      .then(response => response.json())
      .then(data => {
        universities = data;
        initializeCriteria();
      })
      .catch(error => {
        console.error('Error fetching university data:', error);
        document.getElementById('results').innerHTML = "<p>Error loading university data. Please try again later.</p>";
      });

    function initializeCriteria() {
      const container = document.getElementById('criteria-container');
      criteria.forEach(c => {
        const div = document.createElement('div');
        div.className = 'criterion';
        div.innerHTML = `<label for="${c.replace(/\s+/g, '-')}-stars">${c}:</label><div class="stars" data-criterion="${c}" id="${c.replace(/\s+/g, '-')}-stars">
          <span class="star" data-value="1" role="button" aria-label="1 star for ${c}">&#9733;</span>
          <span class="star" data-value="2" role="button" aria-label="2 stars for ${c}">&#9733;</span>
          <span class="star" data-value="3" role="button" aria-label="3 stars for ${c}">&#9733;</span>
          <span class="star" data-value="4" role="button" aria-label="4 stars for ${c}">&#9733;</span>
          <span class="star" data-value="5" role="button" aria-label="5 stars for ${c}">&#9733;</span>
        </div>`;
        container.appendChild(div);
      });

      document.querySelectorAll('.stars').forEach(starContainer => {
        starContainer.addEventListener('click', e => {
          if (!e.target.classList.contains('star')) return;
          const val = parseInt(e.target.dataset.value);
          [...starContainer.children].forEach(star => {
            star.classList.toggle('filled', parseInt(star.dataset.value) <= val);
          });
        });
      });
    }

    document.getElementById('findBtn').addEventListener('click', () => {
      handleFindMatches();
    });

    document.getElementById('findBtnMobile').addEventListener('click', () => {
      handleFindMatches();
      burgerMenu.classList.remove('active');
    });

    function handleFindMatches() {
      const userPrefs = {};
      document.querySelectorAll('.stars').forEach(container => {
        const crit = container.dataset.criterion;
        const filledStars = container.querySelectorAll('.star.filled').length;
        userPrefs[crit] = filledStars;
      });

      const mandatoryCriteria = criteria.filter(c => userPrefs[c] === 5);
      const fourStarCriteria = criteria.filter(c => userPrefs[c] === 4);
      const threeStarCriteria = criteria.filter(c => userPrefs[c] === 3);
      const twoStarCriteria = criteria.filter(c => userPrefs[c] === 2);
      const oneStarCriteria = criteria.filter(c => userPrefs[c] === 1);

      const filtered = universities
        .filter(u => {
          if (mandatoryCriteria.length === 0) return true;
          return mandatoryCriteria.every(c => u[c] === 5);
        })
        .map(u => {
          const fourStarScore = fourStarCriteria.reduce((sum, c) => sum + u[c], 0);
          const threeStarScore = threeStarCriteria.reduce((sum, c) => sum + u[c], 0);
          const twoStarScore = twoStarCriteria.reduce((sum, c) => sum + u[c], 0);
          const oneStarScore = oneStarCriteria.reduce((sum, c) => sum + u[c], 0);
          let score = 0;
          criteria.forEach(c => {
            if (userPrefs[c] !== 5) {
              score += 5 -
