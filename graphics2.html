<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>School Criterion Distribution</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f6f6f8;
    margin: 40px;
    text-align: center;
    position: relative;
    min-height: 100vh;
  }
  .controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin: 20px auto;
    max-width: 600px;
    flex-wrap: wrap;
  }
  .controls label {
    font-size: 16px;
    color: #333;
  }


  /* === HEADER === */
  header {
    background: #1e40af;
    color: white;
    padding: 12px 20px;
    font-size: 1.4rem;
    font-weight: 700;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    display: flex;
    justify-content: flex-start;
    align-items: center;
    position: relative;
  }
  header h1 {
    margin: 0;
    font-size: 1.4rem;
    margin-left: 16px;
  }
  .hamburger {
    position: absolute;
    right: 20px;
    font-size: 1.6rem;
    cursor: pointer;
    padding: 8px;
    border-radius: 6px;
    transition: background 0.3s;
  }
  .hamburger:hover { background: rgba(255,255,255,0.2); }

  /* === MENU OVERLAY === */
  .menu-overlay {
    position: fixed;
    top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.7);
    backdrop-filter: blur(8px);
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s ease;
    z-index: 999;
  }
  .menu-overlay.active {
    opacity: 1;
    visibility: visible;
  }
  .menu-content {
    background: rgba(59,130,246,0.98);
    padding: 2.5rem 1.5rem;
    border-radius: 16px;
    width: 90%;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    transform: scale(0.8);
    transition: transform 0.4s ease;
  }
  .menu-overlay.active .menu-content { transform: scale(1); }
  .menu-content ul { list-style: none; margin-top: 1rem; padding: 0; }
  .menu-content li { margin: 0.8rem 0; }
  .menu-content a {
    color: white;
    text-decoration: none;
    font-size: 1.1rem;
    font-weight: 500;
    display: block;
    padding: 0.6rem 1.2rem;
    border-radius: 10px;
    transition: all 0.3s;
  }
  .menu-content a:hover {
    background: rgba(255,255,255,0.2);
    transform: translateX(6px);
  }

  select {
    padding: 8px 12px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background: white;
    cursor: pointer;
  }
  select:focus {
    outline: 2px solid #666;
  }
  .chart-container {
    width: 60%;
    max-width: 600px;
    margin: 40px auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
  }
  canvas {
    width: 100% !important;
    height: 300px !important;
  }
  h2 {
    margin-bottom: 10px;
  }
  .return-btn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 10px 20px;
    font-size: 16px;
    background: white;
    color: #333;
    border: 1px solid #ccc;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 0 10px #ccc;
    transition: background-color 0.2s, box-shadow 0.2s;
  }
  .return-btn:hover {
    background: #f0f0f0;
    box-shadow: 0 0 12px #bbb;
  }
  .pie-chart-btn {
    position: fixed;
    bottom: 20px;
    left: 20px;
    padding: 10px;
    font-size: 1.5rem;
    background: white;
    color: #333;
    border: 1px solid #ccc;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 10px #ccc;
    transition: background-color 0.2s, box-shadow 0.2s;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .pie-chart-btn:hover {
    background: #f0f0f0;
    box-shadow: 0 0 12px #bbb;
  }
  @media (max-width: 600px) {
    body {
      margin: 20px;
    }
    .controls {
      flex-direction: column;
      gap: 15px;
    }
    select {
      width: 100%;
      max-width: 300px;
    }
    .chart-container {
      width: 100%;
      margin: 20px auto;
      padding: 15px;
    }
    canvas {
      height: 250px !important;
    }
    .return-btn {
      bottom: 15px;
      right: 15px;
      padding: 8px 16px;
      font-size: 14px;
    }
    .pie-chart-btn {
      bottom: 15px;
      left: 15px;
      width: 40px;
      height: 40px;
      font-size: 1.2rem;
    }

    @media (max-width: 600px) {
    header { font-size: 1.2rem; padding: 10px 16px; }
    header h1 { font-size: 1.2rem; margin-left: 12px; }
    .controls { flex-direction: column; gap: 15px; }
    select { width: 100%; max-width: 300px; }
    .chart-container { width: 100%; margin: 20px auto; padding: 15px; }
    canvas { height: 250px !important; }
    .return-btn, .pie-chart-btn { bottom: 15px; }
    .return-btn { right: 15px; padding: 8px 16px; font-size: 14px; }
    .pie-chart-btn { left: 15px; width: 40px; height: 40px; font-size: 1.2rem; }
  }

  
  }
</style>
</head>
<body>

<header>
  <h1>School Criterion Distribution</h1>
  <div class="hamburger" onclick="toggleMenu()">
    <i class="fas fa-bars"></i>
  </div>
</header>

<!-- MENU OVERLAY -->
<div id="menu-overlay" class="menu-overlay">
  <div class="menu-content">
    <ul>
      <li><a href="index.html" onclick="closeMenu()">Home</a></li>
      <li><a href="find.html" onclick="closeMenu()">School Finder</a></li>
      <li><a href="stats4.html" onclick="closeMenu()">Ranking</a></li>
      <li><a href="edc2.html" onclick="closeMenu()">EDC Classification</a></li>
    </ul>
  </div>
</div>

<div class="controls">
  <label for="criterion">Select Criterion:</label>
  <select id="criterion">
    <option value="Scholarship">Scholarship</option>
    <option value="Academic Quality">Academic Quality</option>
    <option value="Employment Opportunities">Employment Opportunities</option>
    <option value="Innovation">Innovation</option>
    <option value="International">International</option>
    <option value="Research">Research</option>
    <option value="Infrastructure">Infrastructure</option>
    <option value="Sports">Sports</option>
    <option value="Food">Food</option>
    <option value="Environment">Environment</option>
  </select>
</div>

<div id="charts"></div>

<!-- Button -->

<!-- Script -->

<button class="pie-chart-btn" onclick="window.location.href='graph3.html'" title="View Pie Charts">ðŸ¥§</button>

<script>

  

  
   function goHome() {
  // Try relative path first
  const mainPage = "index.html"; // adjust if needed
  window.location.href = mainPage;
}

  let schools = [];
  let currentChart = null;
  const criteria = [
    "Scholarship",
    "Academic Quality",
    "Employment Opportunities",
    "Innovation",
    "International",
    "Research",
    "Infrastructure",
    "Sports",
    "Food",
    "Environment"
  ];

  // Load CSV data
  async function loadCSV() {
    const response = await fetch("data.csv");
    const text = await response.text();
    const lines = text.trim().split("\n");
    const headers = lines[0].split(",");
    schools = lines.slice(1).map(line => {
      const values = line.split(",");
      const obj = {};
      headers.forEach((h, i) => {
        const key = h.trim();
        const value = values[i]?.trim();
        obj[key] = isNaN(value) ? value : Number(value);
      });
      return obj;
    });
    updateChart(); // Render initial chart
  }

  // Get counts of schools for scores 1-5 for a criterion
  function getCounts(criterion) {
    const counts = [0, 0, 0, 0, 0];
    schools.forEach(school => {
      const val = school[criterion];
      if (val >= 1 && val <= 5) {
        counts[val - 1]++;
      }
    });
    return counts;
  }

  // Create bar chart for a given criterion
  function createBarChart(criterion) {
    const chartsDiv = document.getElementById("charts");
    chartsDiv.innerHTML = ''; // Clear previous chart
    const counts = getCounts(criterion);
    
    const container = document.createElement("div");
    container.className = "chart-container";
    chartsDiv.appendChild(container);

    const title = document.createElement("h2");
    title.textContent = criterion;
    container.appendChild(title);

    const canvas = document.createElement("canvas");
    container.appendChild(canvas);

    if (currentChart) {
      currentChart.destroy(); // Destroy previous chart
    }
    currentChart = new Chart(canvas.getContext("2d"), {
      type: "bar",
      data: {
        labels: ["1 Ã©toile", "2 Ã©toiles", "3 Ã©toiles", "4 Ã©toiles", "5 Ã©toiles"],
        datasets: [{
          label: `Number of Schools`,
          data: counts,
          backgroundColor: ["#f44336", "#ff9800", "#ffeb3b", "#4caf50", "#2196f3"]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: true,
            max: 50, // Set y-axis max to 50
            ticks: {
              precision: 0,
              stepSize: 10
            },
            title: {
              display: true,
              text: "Number of Schools"
            }
          },
          x: {
            title: {
              display: true,
              text: "Score"
            }
          }
        },
        plugins: {
          legend: { display: false },
          title: {
            display: false
          }
        },
        animation: {
          duration: 1000, // Smooth animation duration
          easing: 'easeOutQuart', // Smooth, slightly bouncy easing
          y: {
            from: 0 // Bars grow from bottom
          }
        }
      }
    });
  }

  // Update chart based on selected criterion
  function updateChart() {
    const criterion = document.getElementById("criterion").value;
    createBarChart(criterion);
  }

  // Main function to initialize
  async function init() {
    await loadCSV();
    document.getElementById("criterion").addEventListener("change", updateChart);
  }

  init();

  // MENU
  function toggleMenu() {
    document.getElementById("menu-overlay").classList.toggle("active");
  }
  function closeMenu() {
    document.getElementById("menu-overlay").classList.remove("active");
  }
</script>

</body>

</html>
